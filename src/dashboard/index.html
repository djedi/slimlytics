---
layout: base.njk
title: Analytics Dashboard
---

<div class="container" x-data="dashboard()" x-init="init()">
  <!-- Header with Site and Date Selectors -->
  <div class="header">
    <div style="display: flex; align-items: center; gap: 20px">
      <a href="/"
        ><img
          src="/images/slimlytics.png"
          alt="Slimlytics"
          style="height: 40px; width: auto"
      /></a>
      
      <!-- Real-time Status Indicator -->
      <div class="realtime-status" 
           :class="{ 'connected': wsConnected, 'disconnected': !wsConnected }"
           :title="wsConnected ? 'Real-time updates active' : 'Connecting to real-time updates...'"
           style="display: flex; align-items: center; gap: 5px; font-size: 12px; padding: 4px 8px; border-radius: 12px; background: rgba(52, 152, 219, 0.1);">
        <span class="status-dot" 
              style="width: 8px; height: 8px; border-radius: 50%; animation: pulse 2s infinite;"
              :style="{ background: wsConnected ? '#27ae60' : '#e74c3c' }"></span>
        <span x-text="wsConnected ? 'Live' : 'Connecting...'"></span>
      </div>

      <!-- Site Selector -->
      <div class="site-selector">
        <button
          class="dropdown-btn"
          @click="siteDropdownOpen = !siteDropdownOpen"
        >
          <span class="emoji-icon">ğŸŒ</span>
          <span x-text="selectedSite"></span>
          <span style="margin-left: auto">â–¼</span>
        </button>
        <div
          class="dropdown-menu"
          x-show="siteDropdownOpen"
          @click.outside="siteDropdownOpen = false"
          x-cloak
        >
          <template x-for="site in sites" :key="site.id">
            <div
              class="dropdown-item"
              :class="{'active': selectedSite === site.name}"
              @click="selectSite(site)"
            >
              <span x-text="site.name"></span>
            </div>
          </template>
          <div
            style="
              border-top: 1px solid #e9ecef;
              margin-top: 5px;
              padding-top: 5px;
            "
          >
            <div class="dropdown-item" @click="goToSiteSettings()">
              <span>âš™ï¸ Site Settings</span>
            </div>
            <div
              class="dropdown-item"
              @click="window.location.href='/add-site'"
            >
              <span>â• Add New Site</span>
            </div>
            <div
              class="dropdown-item"
              @click="window.location.href='/test-events'"
            >
              <span>ğŸ§ª Test Events</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Date Range Selector -->
    <div class="date-selector">
      <button
        class="dropdown-btn"
        @click="dateDropdownOpen = !dateDropdownOpen"
      >
        <span class="emoji-icon">ğŸ“…</span>
        <span x-text="dateRanges[selectedDateRange]"></span>
        <span style="margin-left: auto">â–¼</span>
      </button>
      <div
        class="dropdown-menu"
        x-show="dateDropdownOpen"
        @click.outside="dateDropdownOpen = false"
        x-cloak
      >
        <template x-for="[key, value] in Object.entries(dateRanges)" :key="key">
          <div
            class="dropdown-item"
            :class="{'active': selectedDateRange === key}"
            @click="selectDateRange(key)"
          >
            <span x-text="value"></span>
          </div>
        </template>
      </div>
    </div>
  </div>

  <!-- Main Dashboard Grid -->
  <div class="dashboard-grid">
    <!-- Column 1 -->
    <div>
      <!-- The Basics -->
      <div class="card">
        <div class="card-header">
          <span class="emoji-icon">ğŸ“Š</span>
          The Basics
        </div>
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value" x-text="stats.visitors">0</div>
            <div class="stat-label">ğŸ‘¥ Visitors</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" x-text="stats.pageViews">0</div>
            <div class="stat-label">ğŸ“„ Page Views</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" x-text="stats.avgSessionDuration">0s</div>
            <div class="stat-label">â³ Avg Session</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" x-text="stats.bounceRate">0%</div>
            <div class="stat-label">ğŸ“‰ Bounce Rate</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" x-text="realtimeVisitors">0</div>
            <div class="stat-label">ğŸŸ¢ Online Now</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" x-text="topPages.length">0</div>
            <div class="stat-label">ğŸ“Š Active Pages</div>
          </div>
        </div>
      </div>

      <!-- Recent Visitors -->
      <div class="card">
        <div class="card-header">
          <span class="emoji-icon">ğŸ•</span>
          Recent Visitors
        </div>
        <table class="data-table">
          <thead>
            <tr>
              <th>Location</th>
              <th>IP Address</th>
              <th>Page</th>
              <th>Time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="country-flag">ğŸ‡ºğŸ‡¸</span> United States</td>
              <td>192.168.1.***</td>
              <td><a href="#" class="link">/blog/getting-started</a></td>
              <td class="time-ago">2 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡¬ğŸ‡§</span> United Kingdom</td>
              <td>10.0.0.***</td>
              <td><a href="#" class="link">/products</a></td>
              <td class="time-ago">5 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡©ğŸ‡ª</span> Germany</td>
              <td>172.16.0.***</td>
              <td><a href="#" class="link">/</a></td>
              <td class="time-ago">8 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡«ğŸ‡·</span> France</td>
              <td>192.168.2.***</td>
              <td><a href="#" class="link">/about</a></td>
              <td class="time-ago">12 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡¯ğŸ‡µ</span> Japan</td>
              <td>10.1.1.***</td>
              <td><a href="#" class="link">/contact</a></td>
              <td class="time-ago">15 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡¨ğŸ‡¦</span> Canada</td>
              <td>172.17.0.***</td>
              <td><a href="#" class="link">/pricing</a></td>
              <td class="time-ago">18 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡¦ğŸ‡º</span> Australia</td>
              <td>192.168.3.***</td>
              <td><a href="#" class="link">/docs</a></td>
              <td class="time-ago">22 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡§ğŸ‡·</span> Brazil</td>
              <td>10.2.2.***</td>
              <td><a href="#" class="link">/blog/update-v2</a></td>
              <td class="time-ago">25 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡®ğŸ‡³</span> India</td>
              <td>172.18.0.***</td>
              <td><a href="#" class="link">/features</a></td>
              <td class="time-ago">28 min ago</td>
            </tr>
            <tr>
              <td><span class="country-flag">ğŸ‡ªğŸ‡¸</span> Spain</td>
              <td>192.168.4.***</td>
              <td><a href="#" class="link">/support</a></td>
              <td class="time-ago">30 min ago</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Links (Referrers) -->
      <div class="card">
        <div class="card-header">
          <span class="emoji-icon">ğŸ”—</span>
          Links
        </div>
        <ul class="data-list">
          <template x-for="referrer in topReferrers.slice(0, 8)" :key="referrer.referrer">
            <li class="list-item">
              <span><a href="#" class="link" x-text="referrer.referrer || 'direct'"></a></span>
              <span class="badge primary" x-text="referrer.count"></span>
            </li>
          </template>
          <li class="list-item" x-show="topReferrers.length === 0">
            <span style="color: #999;">No referrers yet</span>
          </li>
        </ul>
      </div>

      <!-- Searches -->
      <div class="card">
        <div class="card-header">
          <span class="emoji-icon">ğŸ”</span>
          Searches
        </div>
        <ul class="data-list">
          <li class="list-item">
            <span>"analytics dashboard"</span>
            <span class="badge success">89</span>
          </li>
          <li class="list-item">
            <span>"web analytics tool"</span>
            <span class="badge success">67</span>
          </li>
          <li class="list-item">
            <span>"google analytics alternative"</span>
            <span class="badge success">45</span>
          </li>
          <li class="list-item">
            <span>"website statistics"</span>
            <span class="badge success">34</span>
          </li>
          <li class="list-item">
            <span>"visitor tracking"</span>
            <span class="badge success">28</span>
          </li>
          <li class="list-item">
            <span>"real time analytics"</span>
            <span class="badge success">23</span>
          </li>
        </ul>
      </div>
    </div>

    <!-- Column 2 -->
    <div>
      <!-- Visitors Chart -->
      <div class="card">
        <div class="card-header">
          <span class="emoji-icon">ğŸ“ˆ</span>
          Visitors
          <select
            style="
              margin-left: auto;
              padding: 5px;
              border: 1px solid #ddd;
              border-radius: 4px;
            "
          >
            <option>Compare to: 7 days ago</option>
            <option>Compare to: Yesterday</option>
            <option>Compare to: 28 days ago</option>
          </select>
        </div>
        <div class="chart-container" x-html="chartSvg"></div>
      </div>

      <!-- Content -->
      <div class="card">
        <div class="card-header">
          <span class="emoji-icon">ğŸ“„</span>
          Content
        </div>
        <ul class="data-list">
          <template x-for="(page, index) in topPages.slice(0, 10)" :key="page.url">
            <li class="list-item">
              <span x-text="page.url"></span>
              <div style="display: flex; align-items: center; gap: 10px">
                <span class="badge" x-text="`${page.views} views`"></span>
                <div class="progress-bar" style="width: 100px">
                  <div class="progress-fill" :style="`width: ${topPages[0] ? (page.views / topPages[0].views * 100) : 0}%`"></div>
                </div>
              </div>
            </li>
          </template>
          <li class="list-item" x-show="topPages.length === 0">
            <span style="color: #999;">No page views yet</span>
          </li>
        </ul>
      </div>

      <!-- Locale -->
      <div class="card">
        <div class="card-header">
          <span class="emoji-icon">ğŸŒ</span>
          Locale
        </div>
        <ul class="data-list">
          <li class="list-item">
            <span><span class="country-flag">ğŸ‡ºğŸ‡¸</span> United States</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge warning">345</span>
              <div class="progress-bar" style="width: 100px">
                <div class="progress-fill" style="width: 75%"></div>
              </div>
            </div>
          </li>
          <li class="list-item">
            <span><span class="country-flag">ğŸ‡¬ğŸ‡§</span> United Kingdom</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge warning">234</span>
              <div class="progress-bar" style="width: 100px">
                <div class="progress-fill" style="width: 55%"></div>
              </div>
            </div>
          </li>
          <li class="list-item">
            <span><span class="country-flag">ğŸ‡©ğŸ‡ª</span> Germany</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge warning">156</span>
              <div class="progress-bar" style="width: 100px">
                <div class="progress-fill" style="width: 35%"></div>
              </div>
            </div>
          </li>
          <li class="list-item">
            <span><span class="country-flag">ğŸ‡«ğŸ‡·</span> France</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge warning">123</span>
              <div class="progress-bar" style="width: 100px">
                <div class="progress-fill" style="width: 28%"></div>
              </div>
            </div>
          </li>
          <li class="list-item">
            <span><span class="country-flag">ğŸ‡¯ğŸ‡µ</span> Japan</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge warning">98</span>
              <div class="progress-bar" style="width: 100px">
                <div class="progress-fill" style="width: 22%"></div>
              </div>
            </div>
          </li>
          <li class="list-item">
            <span><span class="country-flag">ğŸ‡¨ğŸ‡¦</span> Canada</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge warning">87</span>
              <div class="progress-bar" style="width: 100px">
                <div class="progress-fill" style="width: 20%"></div>
              </div>
            </div>
          </li>
        </ul>
      </div>

      <!-- Traffic Sources -->
      <div class="card">
        <div class="card-header">
          <span class="emoji-icon">ğŸš¦</span>
          Traffic Sources
        </div>
        <ul class="data-list">
          <li class="list-item">
            <span>ğŸ” Search Engines</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge primary">456</span>
              <span style="color: #7f8c8d; font-size: 12px">38%</span>
            </div>
          </li>
          <li class="list-item">
            <span>ğŸ”— Direct</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge primary">345</span>
              <span style="color: #7f8c8d; font-size: 12px">29%</span>
            </div>
          </li>
          <li class="list-item">
            <span>ğŸ“± Social Media</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge primary">234</span>
              <span style="color: #7f8c8d; font-size: 12px">20%</span>
            </div>
          </li>
          <li class="list-item">
            <span>ğŸŒ Referral Sites</span>
            <div style="display: flex; align-items: center; gap: 10px">
              <span class="badge primary">156</span>
              <span style="color: #7f8c8d; font-size: 12px">13%</span>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script src="/js/dashboard.js"></script>
