# Default Caddyfile for Slimlytics
# This proxies all requests to the Hono server which serves both API and dashboard

:80 {
    # Enable compression
    encode gzip zstd

    # Health check endpoint (handled by Caddy, not proxied)
    handle /caddy-health {
        respond "OK" 200
    }

    # Proxy everything to the Hono server
    reverse_proxy slimlytics:3000 {
        # WebSocket support is automatic in Caddy 2
        # Health check the backend
        health_uri /health
        health_interval 30s
        health_timeout 5s
    }
}